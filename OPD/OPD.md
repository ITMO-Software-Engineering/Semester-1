# OPD

## 操作系统

- 含义：这个术语通常意味着“软件+固件”，他们深入了解硬件，并利用和控制硬件。 “操作系统”实现了某些原语，这些原语能够被软件（通常称为中间件和应用程序）所使用。在我看来，随着一个操作系统的成长，他们都趋向一种相似的最小化的功能组合，并且位于硬件之上。这种函数可能仅仅是位于“应用程序”和硬件之间的层，或者它可以虚拟化硬件，或虚拟化硬件和应用程序
- 作用：将程序和数据加载到内存中，控制程序的执行，并以人类可理解的形式提供工作结果，并且提供同时执行多个程序的能力
- 分类
  - 个人操作系统：主要目标为个人用户提使用计算系统的便利
  - 服务器：只在处理来自其它系统的大量请求
  - 嵌入式系统：其目的是支持计算系统，传感器，信号转换器和其它设备的硬件功能，例如飞机，航天器，信号，洗衣机等其他包含是计算机的硬件
- 构成：操作系统包含系统内核与用户程序的环境（库，文件）
  - 内核：内核是一组管理用户硬件和程序的子系统。对任何操作系统都至关重要的主要子系统是内存管理、进程和线程管理（负责在一个操作系统上同时执行多个程序）、虚拟文件系统（从操作系统的角度来看，数据交换是使用文件组织的）在 UNIX 中，一切都是文件）、网络子系统、设备驱动程序和特定于平台的代码（支持系统在各种硬件架构上运行的驱动程序）。用户程序通过系统调用接口与内核交互
    - 从用户的角度来看，任何可执行程序都是一个地址空间，它在逻辑上和物理上被划分为几个段。例如，程序本身执行的代码段，运行所需数据所在的数据段，堆栈段，用于存储返回地址和将参数传递给子程序。除了这些主要段之外，还使用堆或堆、共享库段、内存映射文件，即直接映射到进程地址空间的文件等。所有这些段共同构成了在操作系统内部运行并与之交互的进程映像
    - 此外，程序可以使用内核和系统调用接口相互交互。系统调用接口是进程与内核通信的一种标准化方式，用户进程只能通过该接口访问内核服务。
  - 操作环境：这个术语通常描述了一个体系结构框架的组合，有着一些“中间件”功能的应用程序运行在这个体系结构框架之上。这比“纯粹的”硬件实现和/或虚拟化要更高一个层次或者 2 个。操作环境提供了，例如 —— 一组特定的连接到数据库的接口，Web环境，等等。 这显然不是仅仅对硬件的抽象，而是一个系统的软件结构，但并没有直接的硬件实现

### 文件系统

- 文件
  - 概念：UNIX 下一切皆文件，文件时整个文件系统的基础
  - 内容：其中存储所有必要的系统和用户信息
  - 信息
    1. 文件的类型和权限
        - 以 10 位字符表示
        - 第 1 位表示文件类型
          - `-` 常规文件：这包括所有本身就是有价值信息的数据文件
          - `d` 目录：这些文件的数据里记录了其包含的文件和目录的列表。在目录数据中，文件名（可以理解为名称）与其 inode（身份证号）相关联。因此，同一个文件可以存在不同的名称和/或不同的目录中，但所有名称都将与同一个 inode 相关联（硬链接机制）
          - `l` 链接文件：是一个文件，其数据包含通过其名称（但不是通过 inode）指示另一个文件的地址
          - `b` 装置文件里面的可供储存的接口设备（可随机存取装置）
          - `c` 装置文件里面的串行端口设备，例如键盘、鼠标（一次性读取装置）
          - `s` 域套间字（socket）
          - `p` 管道
        - 第 2-4 位表示所有者权限，用 `rwx` 分别表示读，写，执行权限，没有的权限用 `-`表示
        - 第 5-7 位表示所有组权限，表示格式同上
        - 第 8-10 位表示其他用户权限，表示格式同上
    2. 文件的硬连接数
    3. 所有者名称
    4. 所有者组名称
    5. 文件大小（以字节为单位）
    6. 修改时间（默认最后一次修改时间）
- 目录
  - 本质：一种特殊的文件
  - 内容：
    - 作为文件其中存储了所包含的文件名和 inode 号
    - 每个目录都包含两个必须的文件
      - "."文件 - 指向自身的链接
      - ".."文件 - 指向文件层次结构更高的目录的链接
  - 权限
    - `r` 可列出目录中的文件或者是目录情况
    - `w` 可在目录中创建、删除和修改命令下的文件或者是目录
    `x` 可以使用cd命令切换到此目录
    `-` 没有任何此目录的所有权限
  - 常见系统目录
    - `/usr/bin` - 操作系统提供的主要实用程序和程序目录
    - `/usr/lib` - 系统库目录
    - `/var` - 系统日志和工作文件目录
    - `/tmp` - 临时存储目录
    - `/proc` - 包含表示有关用户和操作系统进程的信息的文件目录
  - 路径
    - 绝对路径：从文件系统根目录开始的路径
    - 相对路径：是从当前目录开始的路径
  - 链接：在 *NIX 系统中使用链接可以将相同的文件放在不同的目录中。Linux 中有两种类型的文件链接。这些是 Linux 符号链接和硬链接
    - 硬链接：与原文件具有相同 inode （在同一个挂载点内）的文件，这种类型的链接在文件系统的较低级别实现。该文件仅位于硬盘驱动器上的特定位置。但是这个地方可以被文件系统中的几个链接引用。每个链接都是一个单独的文件，但它们指向硬盘的同一区域。该文件可以在目录之间移动，并且所有链接都将继续工作，因为名称对它们来说并不重要
      - 特点：
        - 只能在同一个文件系统内工作
        - 目录不能被引用
        - **具有与源文件相同的 inode 信息和权限集**
        - 当文件的权限更改时，链接的权限会更改
        - 您可以在不损害链接的情况下移动和重命名甚至删除文件
        - 如果您更改其中一个文件的权限，则会更改另一个文件的权限
    - 软连接（符号链接）：与快捷方式类似，包含原文件绝对路径或相对路径的文件，当您尝试打开此类链接时，将打开目标文件或文件夹。它与硬链接的主要区别在于，当目标文件被删除时，链接将保留，但它不会指向任何地方，因为文件实际上已不存在
      - 特点：
        - 可以引用文件和目录；
        - 删除、移动或重命名文件后失效
        - **访问权限和inode编号与源文件不同**
        - 如果更改源文件的权限，链接的权限将保持不变
        - 可以参考其他磁盘分区
        - 仅包含文件名，不包含其内容
        - 如果一个文件有多个硬链接，那么只有当指向它的 inode 的最后一个链接被删除并且链接计数被重置为 0 时，它才会被删除
    - ln 指令
      - 用法：`ln [参数] 原文件 链接文件`
      - 参数：
        - `d` 允许超级用户为目录创建硬链接
        - `f` 删除现有链接
        - `i` 询问是否应该删除现有链接
        - `P` 创建一个硬链接
        - `s` 创建一个符号链接
        - `r` 创建一个带有文件相对路径的符号链接
    - 注意：您不能根据 POSIX（由 ISO 委员会开发的一组标准）创建指向目录的硬链接，因为在创建目录的硬链接时，访问父文件夹时会有歧义，因为会有几个，加上递归搜索可能会产生死循环，所以禁止创建硬链接
- 文件流
  - 标准输入流（`stdin`(0)）：输入至程序的资料（通常是文件）
  - 标准输出流（`stdout`(1)）：自程序输出的资料
  - 标准错误流（`stderr`(2)）：输出流的一种，子程序输出的错误信息，与标准输出区分

### 指令系统

- 环境与环境变量
  - 系统为每个正在运行的进程提供一定的信息空间，该进程有权随意更改。使用这个空间的规则很简单：您可以在其中设置命名数据存储（环境变量），您可以在其中写入任何信息（分配环境变量的值），然后读取此信息（替换多变的）
  - 每个过程都有参数和环境。进程参数是一个以 `null` 结尾的字符串数组，通常称为 `argv`，并传递给第一个调用的函数。参数的数量称为 `argc`。进程的环境是一个 `VARIABLE = value` 类型的字符串数组，也由 `null` 结尾，并且可以通过全局变量 environ 访问，该变量是（在 C 中）类型为 `char` 的。您可以使用 `printenv [name]` 命令查看环境（如果未指定名称，则显示整个环境）
  - 环境变量：环境变量是命名变量，其中包含运行程序可以使用的文本信息。此类变量可以包含一般系统设置、图形或命令 shell 选项、用户偏好数据等
  - 一些重要的变量
    - `PATH` 系统查找可执行文件的目录列表，当 `ls`、`rc-update` 或 `emerge` 等普通命令被 shell（如bash 或zsh）解释时，shell 在此列表中查找具有指定名称的可执行文件，如果找到，则执行文件，将指定的命令行参数传递给它。而要想运行不在 `PATH` 中的可执行文件，则必须指定文件的完整路径
    - `HOME` 当前用户主目录的路径。应用程序可以使用此变量来定位运行它们的用户的设置文件
    - `PWD` 工作目录的路径
    - `OLDPWD` 上一个工作目录的路径，即最后一次 cd 调用之前 PWD 的值
    - `SHELL` 当前 shell 的名称，例如 bash
    - `TERM` 正在运行的终端程序的名称，例如 xterm
    - `PARGER` 指定运行文本文件分页程序的命令，例如 /bin/less
    - `EDITOR` 运行用于编辑文本文件的程序的命令，例如 /usr/bin/nano。您还可以指定一个特殊的命令，该命令将根据环境选择编辑器，例如 X 中的 gedit 或 nano 终端
    - `MANPATH` `man` 用于查找手册页的目录列表。默认值为 `/usr/share/man:/usr/local/share/man`
    - `TZ` 可用于设置时区。可以在 /usr/share/zoneinfo/ 中找到可用的时区
  - 变量设置
    - 大多数 Linux 发行版都建议在 /etc/profile 或其他地方更改或添加环境变量。请记住，许多文件可以同时包含环境变量并覆盖它们。本质上，可以使用任何脚本来执行此操作，但是，根据 UNIX 约定，只能使用某些文件来执行此操作
    - 以下文件应用于设置系统级环境变量：/etc/profile、/etc/bash.bashrc 和 /etc/environment。这些文件中的每一个都有其局限性，因此您应该仔细选择适合您目的的文件
      - /etc/profile 仅为 shell 设置变量。它可以在 Bourne shell 兼容的 shell 中运行任何脚本
      - /etc/bash.bashrc 仅为交互式 shell 设置变量。它还运行 bash 脚本
      - /etc/environment 由 PAM-env 模块使用。此处只能指定名称=值对
    - 在用户层面设置
      - 您并不总是需要在系统级别设置环境变量。例如，您打算将 `/home/user/bin` 目录添加到 `PATH`，但您不希望系统上的其他用户受到影响。用户环境变量可以在许多其他文件中设置
      - Shell 初始化文件，例如
      - `~/.profile` 也被许多 shell 使用，
      - `~/.pam_environment` 是 PAM-env 模块使用的 `/etc/environment` 的自定义版本。有关详细信息，请参阅 pam_env(8)
      - 例如，要将目录添加到 `PATH`，请将以下内容放入 `~/.bash_profile`
- 信号
  - 概念：在现代操作系统中，有进程间通信（Inter-Process Communication - IPC）的概念——这是一组用于在进程和/或线程之间交换数据的方法。信号就是这样一种交换方法
  - 作用：信号能够在随机时间（异步）中断进程以处理某些事件。一个进程可以被另一个进程或内核发起的信号中断。内核使用信号来通知进程各种事件，例如子进程的终止
  - 实现
    - 在信号出现时立即中断进程并开始处理它
    - 设置一个标志，然后将控制权转移给处理程序，这样信号处理内部的信号出现就不会出现问题
  - 常见信号：
    - `SIGINT（编号2）` 如果终端用户已发出终止进程的命令（通常此命令是键盘快捷键Ctrl-C ），则该信号通常会发送到进程
    - `SIGABRT（编号 6）`作为调用 abort(3) 函数的结果发送到程序。结果，程序以将内存映像保存在磁盘上结束
    - `SIGKILL（数字 9`）`终止程序。程序既不能处理也不能忽略这个信号
    - `SIGSEGV （编号 11）`被发送到试图访问不属于它的内存区域的进程。如果未安装信号处理程序，则程序将退出，并将内存映像保存到磁盘
    - `SIGTERM （数字 15）`导致程序礼貌地终止。收到这个信号后，程序可以在完成前执行必要的操作（例如，释放占用的资源）。收到 SIGTERM 并不表示程序有错误，而是操作系统或用户希望终止它
    - 如果子进程已终止或挂起，则将 `SIGCHLD（编号 17）`发送给进程。如果父进程设置了子进程的信号跟踪模式并且子进程收到了任何信号，父进程也会收到这个信号。默认情况下，SIGCHLD 信号被忽略
    - `SIGCONT （编号 18）`恢复执行由 SIGSTOP 信号停止的进程
    - `SIGSTOP （编号 19）`暂停进程的执行。像 SIGKILL 一样，这个信号不能被捕获或忽略
    - `SIGTSTP （编号 20）`根据用户的命令（通常该命令是键盘快捷键 Ctrl-Z）暂停进程
    - `SIGIO / SIGPOLL（在 Linux 中，两个常量都代表一个信号 - 数字 29）`告诉进程数据已经出现在异步打开的句柄之一上。默认情况下，终止程序
  > 有关系统信号的[更多信息](https://www.ibm.com/developerworks/ru/library/l-signals_1/index.html)
- 命令行参数
  - 概念：shell 最重要的特性之一是处理命令行的能力。当您在 shell 提示符后键入命令并按 Enter 键时，shell 会继续处理命令行，将其拆分为 arguments 。在处理命令行时，shell 可以对您传递的参数进行许多更改。这个过程称为 shell 命令扩展。在 shell 完成对传递的命令字符串的处理和修改后，将直接执行生成的命令。而在调用程序时，数据会从命令行传输到程序。此类数据称为命令行参数
  - 当从命令行调用程序时，总是会传递一对数据给它：
    - 一个整数，表示调用时命令行上的单词数（由空格分隔的元素）
    - 指向字符串数组的指针，其中每个字符串都是命令行中的一个单词
- 常用快捷键
  - Ctrl + C - 使终端向当前控制它的进程发送一个 `SIGINT` 信号。当前台程序收到 `SIGINT` 信号时，它必须中止
  - Ctrl + D - 告诉终端注册所谓的 EOF（文件结束 - 文件结束），即输入流结束。Bash 将此解释为希望退出程序
  - Ctrl + Z - 向进程发送一个信号，告诉它停止。这意味着该进程仍保留在系统中，但可以说是被冻结了。不用说，他进入了背景（背景）——在背景中。使用 `bg` 命令，您可以再次启动它，同时将其留在后台。`fg` 命令不仅恢复了先前挂起的进程，而且还把它从后台带到了前台
- 输入输出重定向
  - `> file` 将标准输出流重定向至 file 文件并覆盖
  - `>> file` 将标准输出流重定向至 file 文件并在其后添加
  - `2> file` 将标准错误流重定向至 file 文件并覆盖
  - `2>> file` 将标准错误流重定向至 file 文件并在其后添加
  - `< file` 将 file 文件的内容重定向至标准输入
  - `<< EOF` 将后续从终端连续输入直到 "EOF" 的内容重定向至标准输入流
  - `|` 管道符，将上一个命令的标准输出链接到下一个命令的标准输入
- 基础命令
  - `mkdir` 创建目录
    - 用法 `mkdir [参数] 目录名`
    - 参数
      - `-p` 若路径中的某些目录尚不存在，加上此选项后，系统将自动建立好那些尚不存在的目录，即一次可以建立多级目录
      - `-m` 创建目录的同时设定权限（类似 `chmod`）
      - `-v` 创建目录后显示信息
  - `echo` 
    - 用法 `echo [参数] [字符串]`
    - 参数
      - `-n` 不在最后自动换行
      - `-e` 对于以下字符加以处理
        - `\a` 发出警告声
        - `\b` 删除前一个字符
        - `\c` 最后不加上换行符号
        - `\f` 换行但光标仍旧停留在原来的位置
        - `\n` 换行且光标移至行首
        - `\r` 光标移至行首，但不换行
        - `\t` 插入tab
        - `\v` 插入垂直表格跳位键
        - `\\` 插入\字符
        - `\nnn` 插入 nnn（八进制）所代表的 ASCII 字符
    - 字符串
      - 可以不带引号输入，此时将忽略字符串中的空格
      - 若带引号输入，则保留引号中字符串包含的空格
  - `cat` 连接文件或标准输入并打印。这个命令常用来显示文件内容，或者将几个文件连接起来显示，或者从标准输入读取内容并显示
    - 用法 `cat [参数] 文件`
    - 参数
      - `-n` 对输出的所有行编号
  - `touch` 用来修改文件时间戳，或者新建一个不存在的文件
    - 用法 `touch [参数] 文件`
    - 参数
      - `-a` 只更改存取时间
      - `-m` 之更改变动时间
  - `ls` 列出目标目录中所有的子目录和文件
    - 用法 `ls [参数] 目录名`
    - 参数
      - `-a` 列出目录下的所有文件，包括以 `.` 开头的隐含文件
      - `-A` 同 `-a`，但不列出 `.` 及 `..` 文件
      - `-S` 根据文件大小排序
      - `-s` 以块大小为单位列出所有文件的大小
      - `-R` 同时列出所有的子目录内容
      - `-r` 以相反次序排列
      - `-l` 以长格式列出文件的详细信息
      - `-t` 以文件修改时间排序，新的在前
  - `pwd` 显示当前目录
  - `cd` 移动至指定目录
  - `rm` 删除指定文件
    - 用法 `rm [参数] 文件地址`
    - 参数
      - `-i` 删除前逐一确认
      - `-f` 强制删除，无需确认
      - `r` 递归删除目录及目录一下的文件
  - `rmdir` 删除空目录
  - `mv` 用来移动文件或者将文件改名
    - 用法 `mv [参数] 原文件 目标文件`
    - 参数
      - `-b` 如果目标文件存在，则在覆盖之前备份
      - `-f` 强制移动，若目标文件存在则直接覆盖
      - `-i` 若目标文件存在，则询问是否覆盖
      - `-u` 若目标文件已经存在，且原文件较新，则会更新
  - `head` 用来显示档案的开头
    - 用法 `mv [参数] 文件`
    - 参数
      - `-q` 隐藏文件名
      - `-v` 显示文件名
      - `-c` 设定显示字节数
      - `-n` 设定显示行数
  - `tail`用来显示档案的结尾
  - `sort` 排序命令
    - 用法 `sort [参数] 文件`
    - 原理：将每一行为单位，互相比较，按 ASCII 码值进行比较，默认以升序输出
    - 参数
      - `-r` 将默认的升序改为降序
      - `-u` 在输出中去除重复行
      - `-o` 把结果输出写入到指定文件，例如将文件内容排序后写入到原来的文件，此时不能用重定向，只能用该参数
      - `-n` 按数字大小排序
      - `-t` 设定列分隔符 默认以空格分列
      - `-k` 按指定列排序
  - `grep`
    - 参数
      - `-l` 仅输出匹配的内容匹配的文件名
      - `-n` 显示符合样式的那一行之前，标示出该行的列数编号
      - `-o` 只显示匹配 PATTERN 部分
      - `-s` 不显示错误信息
  - `wc` 计算文件的字节数，字数或列数
    - 参数
      - `-c` 只显示字节数
      - `-l` 只显示行数
      - `-w` 只显示字数
> 有关命令的[更多信息](https://docs.google.com/document/u/0/d/1Bc6oI4yNCBIUSL9HYmv4jfmCJZzMQJRaJLEnP4KGhTY/mobilebasic)

## 微机原理

### 微机组成原理

### 微机指令原理
- 取值范围计算
  - 逻辑运算
    - 范围任取
  - 算数运算
    - 加法（A+B）
      1. 情况1  
        $$-2^{14}<=A,B<=2^{14}
        $$
      2. 情况2
        $$-2^{15}<=A<=0\\
        2^{14}<=B<=2^{15}-1\\
        $$
      4. 情况3
        $$0<=A<=2^{15}-1\\
        -2^{15}<=B<=-2^{14}-1\\
        $$
      - 减法（A-B）
        - 算法同加法，将-B当作B即可
        
- 寄存器
  - IP（Instruction Pointer）指令指针，存储下一条命令的地址
  - CR（Command Register）命令寄存器，存储下一条命令的内容
  - AR（Address Register）地址寄存器，访问命令前再此存放命令地址
  - DR（Data Register）数据寄存器，用于从储存但愿读取或写入数据
  - SP（Stack Pointer）栈指针，11位，总是指向栈顶
  - BR（Buffer Register）缓冲寄存器，用于存储运算过程中的临时数据
  - AC（Accumulator）
  - NZVC
    - N - 负数符号位
    - Z - 0 符号位
    - V - 溢出位
    - C - 最高进位借位
- 指令
  - 寻址指令
    指令码 | 助记符 | 作用
    ------|--------|----
    2XXX | AND M | M&AC->AC
    3XXX | OR M | \^(\^M&\^AC)->AC
    4XXX | ADD M | M+AC->AC
    5XXX | ADC M | M+AC+C->AC
    6XXX | SUB M | AC-M->AC
    7XXX | CMP M | 同 SUB M 只是计算结果不存进 AC 只改变标识符
    8XXX | LOOP M | M-1->M IF M<=0 IP+1->IP
    9XXX |       | 
    AXXX | LD M | M->AC
    BXXX | SWAM M | M<->AC
    CXXX | JUMP M | M->IP
    DXXX | CALL M | SP-1->SP IP->SP M->IP
    EXXX | ST M | AC->M
  - 非寻址指令
    指令码 | 助记符 | 作用
    ------|--------|----
    0000 | NOP | 
    0100 | HLT | 终止
    0200 | CLA | 0->AC
    0280 | NOT | \^AC->AC
    0300 | CLC | 0->C
    0380 | CMC | \^C->C
    0400 | ROL | 循环左移
    0480 | ROR | 循环右移
    0500 | ASL | 算数左移
    0580 | ASR | 算数右移
    0600 | SXTB | 延长符号位
    0680 | SWAB | 交换高低字节
    0700 | INC | AC+1->AC
    0780 | DEC | AC-1->AC
    0800 | NEG | \^AC+1->AC
    0900 | 
    0A00 | 
    0B00 | 
    0C00 | 
    0D00 | 
    0E00 | 
